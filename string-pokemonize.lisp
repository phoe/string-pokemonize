;;;; StRiNg-pOkEmOnIzE.LiSp
;;;; MiT LiCeNsE
;;;; ® 2017 MiChAł \"pHoE\" HeRdA

(DeFpAcKaGe #:sTrInG-PoKeMoNiZe
  (:uSe #:cL)
  (:eXpOrT #:StRiNg-pOkEmOnIzE))

(In-pAcKaGe #:sTrInG-PoKeMoNiZe)

(DeFuN StRiNg-pOkEmOnIzE (sTrInG &kEy (StArT 0) eNd)
  (cHeCk-tYpE StArT FiXnUm)
  (lEt ((rEsUlT (mAkE-ArRaY (lEnGtH StRiNg) :eLeMeNt-tYpE 'cHaRaCtEr))
        (EnD (oR EnD (lEnGtH StRiNg)))
        (fLaG NiL))
    (dEcLaRe (DyNaMiC-ExTeNt fLaG)
             (bOoLeAn fLaG)
             (fIxNuM StArT EnD)
             (oPtImIzE (sPeEd 3)
                       (DeBuG 1)
                       (sAfEtY 1)))
    (FlEt ((pOkEmOnIzE (cHaR)
             (dEcLaRe (ChArAcTeR ChAr))
             (sEtF FlAg (NoT FlAg))
             (iF FlAg
                 (cHaR-DoWnCaSe cHaR)
                 (cHaR-UpCaSe cHaR))))
      (dEcLaRe (InLiNe pOkEmOnIzE))
      (lOoP FoR I FrOm sTaRt bElOw eNd
            dO (sEtF (aReF ReSuLt i)
                     (PoKeMoNiZe (ChAr sTrInG I)))
            fInAlLy (ReTuRn rEsUlT)))))
